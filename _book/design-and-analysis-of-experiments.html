<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Design and Analysis of Experiments | An Introduction to Experimental Design ANOVA and ANCOVA</title>
  <meta name="description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Design and Analysis of Experiments | An Introduction to Experimental Design ANOVA and ANCOVA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Design and Analysis of Experiments | An Introduction to Experimental Design ANOVA and ANCOVA" />
  
  <meta name="twitter:description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  

<meta name="author" content="Andrew P Beckerman (with support from text and slides from Mark Rees and Gareth Phoenix)" />


<meta name="date" content="2022-11-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="examples-and-challenge-questions.html"/>
<link rel="next" href="randomized-complete-block-design-rcb.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Experimental Design, ANOVA and ANCOVA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-three-rs-the-foundation-of-experimental-design."><i class="fa fa-check"></i><b>1.1</b> The Three Rs: The Foundation of Experimental Design.</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-general-linear-model"><i class="fa fa-check"></i><b>1.2</b> The General Linear Model</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#install-some-extra-packages--"><i class="fa fa-check"></i><b>1.3</b> Install some extra packages —-</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction To Experimental Design</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#conepts-associated-with-causation"><i class="fa fa-check"></i><b>2.1</b> Conepts associated with causation</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#components-of-an-experiment"><i class="fa fa-check"></i><b>2.2</b> Components of an Experiment</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#the-holy-grail-of-a-control"><i class="fa fa-check"></i><b>2.3</b> The holy grail of a control</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#so-what-does-a-good-experimental-design-do"><i class="fa fa-check"></i><b>2.4</b> So what does a good experimental design do?</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#how-do-we-increase-precision-and-reduce-bias"><i class="fa fa-check"></i><b>2.5</b> How do we increase precision and reduce bias?</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#blinding"><i class="fa fa-check"></i><b>2.5.1</b> Blinding</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#placebos"><i class="fa fa-check"></i><b>2.5.2</b> Placebos</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#confounders"><i class="fa fa-check"></i><b>2.5.3</b> Confounders</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#experimental-vs.-measurement-units"><i class="fa fa-check"></i><b>2.6</b> Experimental vs. Measurement units</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="intro.html"><a href="intro.html#experimental-and-measurement-units-an-example"><i class="fa fa-check"></i><b>2.6.1</b> Experimental and measurement units: an example</a></li>
<li class="chapter" data-level="2.6.2" data-path="intro.html"><a href="intro.html#identifying-the-experimental-unit---an-example-of-pseudo-replication"><i class="fa fa-check"></i><b>2.6.2</b> Identifying the experimental unit - an example of <strong>pseudo-replication</strong></a></li>
<li class="chapter" data-level="2.6.3" data-path="intro.html"><a href="intro.html#psudo-replication"><i class="fa fa-check"></i><b>2.6.3</b> Psudo-replication</a></li>
<li class="chapter" data-level="2.6.4" data-path="intro.html"><a href="intro.html#randomization-with-replication-protects-against-confounding"><i class="fa fa-check"></i><b>2.6.4</b> Randomization with Replication protects against Confounding</a></li>
<li class="chapter" data-level="2.6.5" data-path="intro.html"><a href="intro.html#haphazard-is-not-randomized---beware-the-non-randomized-experiment"><i class="fa fa-check"></i><b>2.6.5</b> <strong>haphazard</strong> is NOT randomized - beware the non-randomized experiment –</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#mini-quiz"><i class="fa fa-check"></i><b>2.7</b> Mini-Quiz</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#replication-how-many"><i class="fa fa-check"></i><b>2.8</b> Replication: How many?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html"><i class="fa fa-check"></i><b>3</b> Examples and Challenge Questions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html#designing-your-first-experiment"><i class="fa fa-check"></i><b>3.1</b> Designing your first experiment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>4</b> Design and Analysis of Experiments</a>
<ul>
<li class="chapter" data-level="4.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#a-crd-completely-randomised-design-example"><i class="fa fa-check"></i><b>4.1</b> A CRD (Completely Randomised Design) Example</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-dplyr-and-ggplot-pipeline-for-inference."><i class="fa fa-check"></i><b>4.1.1</b> The dplyr and ggplot pipeline for inference.</a></li>
<li class="chapter" data-level="4.1.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-one-way-anova."><i class="fa fa-check"></i><b>4.1.2</b> The One-Way ANOVA.</a></li>
<li class="chapter" data-level="4.1.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#making-insight-and-inference"><i class="fa fa-check"></i><b>4.1.3</b> Making insight and inference</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#a-priori-vs.-post-hoc-contrasts"><i class="fa fa-check"></i><b>4.2</b> A priori vs. Post-Hoc Contrasts</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#custom-contrasts-versus-the-tukey-test"><i class="fa fa-check"></i><b>4.2.1</b> Custom contrasts versus the Tukey Test</a></li>
<li class="chapter" data-level="4.2.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-write-up-using-contrasts."><i class="fa fa-check"></i><b>4.2.2</b> The Write Up using contrasts.</a></li>
<li class="chapter" data-level="4.2.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#coming-back-to-randomisation"><i class="fa fa-check"></i><b>4.2.3</b> Coming Back to Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-rcbd---the-randomised-complete-block-design"><i class="fa fa-check"></i><b>4.3</b> THE RCBD - The Randomised Complete Block Design</a></li>
<li class="chapter" data-level="4.4" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#an-example-of-the-rcbd"><i class="fa fa-check"></i><b>4.4</b> An example of the RCBD</a></li>
<li class="chapter" data-level="4.5" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#analysing-the-crbd"><i class="fa fa-check"></i><b>4.5</b> Analysing the CRBD</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#building-the-model"><i class="fa fa-check"></i><b>4.5.1</b> Building the model</a></li>
<li class="chapter" data-level="4.5.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#are-the-estimates-of-the-parameters-what-we-expect"><i class="fa fa-check"></i><b>4.5.2</b> Are the estimates of the parameters what we expect?</a></li>
<li class="chapter" data-level="4.5.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#correct-standard-errors-for-a-figure"><i class="fa fa-check"></i><b>4.5.3</b> Correct Standard Errors for a Figure</a></li>
<li class="chapter" data-level="4.5.4" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#making-inference-confidence-intervals-and-contrasts"><i class="fa fa-check"></i><b>4.5.4</b> Making inference: confidence intervals and contrasts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html"><i class="fa fa-check"></i><b>5</b> Randomized Complete Block design (RCB)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#an-example-of-the-rcbd-1"><i class="fa fa-check"></i><b>5.1</b> An example of the RCBD</a></li>
<li class="chapter" data-level="5.2" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#analysing-the-crbd-1"><i class="fa fa-check"></i><b>5.2</b> Analysing the CRBD</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#building-the-model-1"><i class="fa fa-check"></i><b>5.2.1</b> Building the model</a></li>
<li class="chapter" data-level="5.2.2" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#are-the-estimates-of-the-parameters-what-we-expect-1"><i class="fa fa-check"></i><b>5.2.2</b> Are the estimates of the parameters what we expect?</a></li>
<li class="chapter" data-level="5.2.3" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#correct-standard-errors-for-a-figure-1"><i class="fa fa-check"></i><b>5.2.3</b> Correct Standard Errors for a Figure</a></li>
<li class="chapter" data-level="5.2.4" data-path="randomized-complete-block-design-rcb.html"><a href="randomized-complete-block-design-rcb.html#making-inference-confidence-intervals-and-contrasts-1"><i class="fa fa-check"></i><b>5.2.4</b> Making inference: confidence intervals and contrasts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html"><i class="fa fa-check"></i><b>6</b> Designs for testing for interactions: factorial designs.</a>
<ul>
<li class="chapter" data-level="6.1" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#introducing-interactions"><i class="fa fa-check"></i><b>6.1</b> Introducing Interactions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#lets-design-an-experiment-again"><i class="fa fa-check"></i><b>6.1.1</b> Let’s design an experiment, again…</a></li>
<li class="chapter" data-level="6.1.2" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#the-factorial-design-how-and-why-study-interactions"><i class="fa fa-check"></i><b>6.1.2</b> The Factorial Design: How and Why Study Interactions?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#a-factorial-design-and-the-two-way-anova"><i class="fa fa-check"></i><b>6.2</b> A Factorial Design and the Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#build-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Build the Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#plot-the-data"><i class="fa fa-check"></i><b>6.2.2</b> Plot the data!</a></li>
<li class="chapter" data-level="6.2.3" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#analyse-the-data"><i class="fa fa-check"></i><b>6.2.3</b> Analyse the data</a></li>
<li class="chapter" data-level="6.2.4" data-path="designs-for-testing-for-interactions-factorial-designs..html"><a href="designs-for-testing-for-interactions-factorial-designs..html#final-figuring"><i class="fa fa-check"></i><b>6.2.4</b> final figuring</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="a-summary-experimental-design-and-anova.html"><a href="a-summary-experimental-design-and-anova.html"><i class="fa fa-check"></i><b>7</b> A Summary: Experimental Design and ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="a-summary-experimental-design-and-anova.html"><a href="a-summary-experimental-design-and-anova.html#how-to-analyse-anova-models"><i class="fa fa-check"></i><b>7.1</b> How To Analyse ANOVA models</a></li>
<li class="chapter" data-level="7.2" data-path="a-summary-experimental-design-and-anova.html"><a href="a-summary-experimental-design-and-anova.html#experimental-designs."><i class="fa fa-check"></i><b>7.2</b> Experimental Designs.</a></li>
<li class="chapter" data-level="7.3" data-path="a-summary-experimental-design-and-anova.html"><a href="a-summary-experimental-design-and-anova.html#clever-r-stuff"><i class="fa fa-check"></i><b>7.3</b> Clever R Stuff</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html"><i class="fa fa-check"></i><b>8</b> Introducing the ANCOVA - the analysis of covariance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#setting-up-the-various-ideas."><i class="fa fa-check"></i><b>8.1</b> Setting up the various ideas.</a></li>
<li class="chapter" data-level="8.2" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#working-through-and-example."><i class="fa fa-check"></i><b>8.2</b> Working through and example.</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#get-the-data-and-make-your-picture"><i class="fa fa-check"></i><b>8.2.1</b> Get the data and make your picture</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#building-the-model-and-understanding-it"><i class="fa fa-check"></i><b>8.3</b> Building the model (and understanding it)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#dealing-with-some-issues-with-residuals."><i class="fa fa-check"></i><b>8.3.1</b> Dealing with some issues with residuals.</a></li>
<li class="chapter" data-level="8.3.2" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#making-inference-on-the-ancova"><i class="fa fa-check"></i><b>8.3.2</b> Making inference on the ANCOVA</a></li>
<li class="chapter" data-level="8.3.3" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#the-summary-table-and-making-sense-of-the-log-stuff."><i class="fa fa-check"></i><b>8.3.3</b> The summary table and making sense of the log stuff.</a></li>
<li class="chapter" data-level="8.3.4" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#the-equations-supported-by-the-model."><i class="fa fa-check"></i><b>8.3.4</b> The equations supported by the model.</a></li>
<li class="chapter" data-level="8.3.5" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#making-even-more-inference-and-drawing-the-picture"><i class="fa fa-check"></i><b>8.3.5</b> Making even more inference and drawing the picture</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#some-general-principles"><i class="fa fa-check"></i><b>8.4</b> Some General Principles</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#ancova-always-tests-the-interaction-against-the-additive-model"><i class="fa fa-check"></i><b>8.4.1</b> ANCOVA always tests the interaction against the additive model</a></li>
<li class="chapter" data-level="8.4.2" data-path="introducing-the-ancova---the-analysis-of-covariance.html"><a href="introducing-the-ancova---the-analysis-of-covariance.html#specifying-models-in-r"><i class="fa fa-check"></i><b>8.4.2</b> Specifying models in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>9</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="introduction-1.html"><a href="introduction-1.html#the-three-rs-the-foundation-of-experimental-design.-1"><i class="fa fa-check"></i><b>9.1</b> The Three Rs: The Foundation of Experimental Design.</a></li>
<li class="chapter" data-level="9.2" data-path="introduction-1.html"><a href="introduction-1.html#the-general-linear-model-1"><i class="fa fa-check"></i><b>9.2</b> The General Linear Model</a></li>
<li class="chapter" data-level="9.3" data-path="introduction-1.html"><a href="introduction-1.html#install-some-extra-packages---1"><i class="fa fa-check"></i><b>9.3</b> Install some extra packages —-</a></li>
<li class="chapter" data-level="9.4" data-path="introduction-1.html"><a href="introduction-1.html#conepts-associated-with-causation-1"><i class="fa fa-check"></i><b>9.4</b> Conepts associated with causation</a></li>
<li class="chapter" data-level="9.5" data-path="introduction-1.html"><a href="introduction-1.html#components-of-an-experiment-1"><i class="fa fa-check"></i><b>9.5</b> Components of an Experiment</a></li>
<li class="chapter" data-level="9.6" data-path="introduction-1.html"><a href="introduction-1.html#how-do-we-increase-precision-and-reduce-bias-1"><i class="fa fa-check"></i><b>9.6</b> How do we increase precision and reduce bias?</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="introduction-1.html"><a href="introduction-1.html#blinding-1"><i class="fa fa-check"></i><b>9.6.1</b> Blinding</a></li>
<li class="chapter" data-level="9.6.2" data-path="introduction-1.html"><a href="introduction-1.html#placebos-1"><i class="fa fa-check"></i><b>9.6.2</b> Placebos</a></li>
<li class="chapter" data-level="9.6.3" data-path="introduction-1.html"><a href="introduction-1.html#confounders-1"><i class="fa fa-check"></i><b>9.6.3</b> Confounders</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="introduction-1.html"><a href="introduction-1.html#experimental-vs.-measurement-units-1"><i class="fa fa-check"></i><b>9.7</b> Experimental vs. Measurement units</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="introduction-1.html"><a href="introduction-1.html#the-challenge-question-1"><i class="fa fa-check"></i><b>9.7.1</b> The challenge question</a></li>
<li class="chapter" data-level="9.7.2" data-path="introduction-1.html"><a href="introduction-1.html#identifying-the-experimental-unit---an-example-of-pseudo-replication-1"><i class="fa fa-check"></i><b>9.7.2</b> Identifying the experimental unit - an example of <strong>pseudo-replication</strong></a></li>
<li class="chapter" data-level="9.7.3" data-path="introduction-1.html"><a href="introduction-1.html#psudo-replication-1"><i class="fa fa-check"></i><b>9.7.3</b> Psudo-replication</a></li>
<li class="chapter" data-level="9.7.4" data-path="introduction-1.html"><a href="introduction-1.html#randomization-properly-with-replication-protects-against-confounding"><i class="fa fa-check"></i><b>9.7.4</b> Randomization properly with Replication protects against Confounding</a></li>
<li class="chapter" data-level="9.7.5" data-path="introduction-1.html"><a href="introduction-1.html#haphazard-is-not-randomized---beware-the-non-randomized-experiment-1"><i class="fa fa-check"></i><b>9.7.5</b> <strong>haphazard</strong> is NOT randomized - beware the non-randomized experiment –</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="introduction-1.html"><a href="introduction-1.html#mini-quiz-1"><i class="fa fa-check"></i><b>9.8</b> Mini-Quiz</a></li>
<li class="chapter" data-level="9.9" data-path="introduction-1.html"><a href="introduction-1.html#replication-how-many-1"><i class="fa fa-check"></i><b>9.9</b> Replication: How many?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Experimental Design ANOVA and ANCOVA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="design-and-analysis-of-experiments" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Design and Analysis of Experiments<a href="design-and-analysis-of-experiments.html#design-and-analysis-of-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section we are going to learn about how to implement two experimental designs:</p>
<ul>
<li>CRD: the completely randomised design</li>
<li>CRBD: the completely randomised block design.</li>
</ul>
<p>These two designs are valuable in dealing with two things that make it hard to make strong inference from experiments: <em>noise</em> and <em>counfounding effects</em>.</p>
<p>These unwated sources of variation comes in two forms (see <a href="https://dzchilds.github.io/stats-for-bio/principles-experimental-design.html#confounded-and-noisy-experiments">APS 240 reading</a>)</p>
<ol style="list-style-type: decimal">
<li><p>The first is <em>confounding variation</em>. This occurs when there are one or more other sources of variation that work in parallel to the factor we are investigating and make it hard, or impossible, to unambiguously attribute any effects we see to a single cause. Confounding variation is particularly problematic in observational studies because, by definition, we don’t manipulate the factors we’re interested in.</p></li>
<li><p>The second is <em>noise</em>. This describes variation that is unrelated to the factor we are investigating but adds variability to the results so that it is harder to see, and detect statistically, any effect of that factor. As noted above, much of experimental design is about improving our ability to account for noise in a statistical analysis.</p></li>
</ol>
<p>We will consider these together, as some of the techniques for dealing with them are be applicable to both. The primary tools for dealing with them are</p>
<ol style="list-style-type: decimal">
<li>randomisation</li>
<li>blocking</li>
<li>appropriate controls</li>
<li>additional treatments.</li>
</ol>
<p>In the following sections, we are going to focus on the first three. In doing so, we will also revisit how we make inference from 1-way ANOVA experiments and introduce a more generalised approach to making <em>contrasts</em> we want. If you recall from the 1-way ANOVA work you did in the previous module (Week 7), we learned about <em>treatment contrasts</em>, the default comparison of means to a reference level, and then the <em>Tukey test</em>, which makes all pairwise comparisons. Here will will find an intermediate zone.</p>
<div id="a-crd-completely-randomised-design-example" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> A CRD (Completely Randomised Design) Example<a href="design-and-analysis-of-experiments.html#a-crd-completely-randomised-design-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The experiment is about plant crop biomass yield under several herbicide treatments - the herbicide targets weeds and not our target plant (e.g. Glyphosate): a control and two herbicides, and a third treatment that is a placebo - applied water but no herbicide.</p>
<p>The data for this example are called <code>plantYield.csv</code>.</p>
<p>For each treatment, we have n = 30 plants in separate pots in standarised conditions.</p>
<p>Can you explain why we are using the placebo? Do you know the measurement and experimental unit? As this is a 1-way ANOVA, what is the baseline hypothesis? Given that there is a control and two herbicides, are there alternative hypotheses you might test?</p>
<p>Let’s look at the structure of the design. As hoped, we have 30 replicates of each treatment. The second view reveals that the replicates are allocated randomly among the replicate plants. There is no order to the values in the <code>treat</code> column.</p>
<pre><code>## treat
##    Cont   Herb1   Herb2 Placebo 
##      30      30      30      30</code></pre>
<pre><code>##    plots r   treat
## 1      1 1 Placebo
## 2      2 2 Placebo
## 3      3 1    Cont
## 4      4 3 Placebo
## 5      5 1   Herb2
## 6      6 2    Cont
## 7      7 1   Herb1
## 8      8 2   Herb2
## 9      9 3    Cont
## 10    10 4 Placebo</code></pre>
<p>We have now added data to this design in order to start doing statistics. The <em>TRUTH</em> of these data are that on average, the controls have a yield of 20, Herbicide 1 increases yield by 5, Herbicide 2 by 6 and the placebo by 1 unit. These data are also quite variable. The standard deviation around the yields is large. We are going to analyse these data and</p>
<ol style="list-style-type: decimal">
<li>see if we can recover these estimates of ‘known’ yield.</li>
<li>test the null hypothesis.</li>
<li>test the hypothesis that herbicides, on average, increase yield.</li>
<li>test whether the two herbicides are different.</li>
<li>test whether the placebo is different from the control.</li>
</ol>
<p>And there is the answer to one of the questions above!</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="design-and-analysis-of-experiments.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the design now.</span></span>
<span id="cb3-2"><a href="design-and-analysis-of-experiments.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(plantYield)</span></code></pre></div>
<pre><code>##   plots r   treat      obs
## 1     1 1 Placebo 27.54449
## 2     2 2 Placebo 22.39018
## 3     3 1    Cont 18.23051
## 4     4 3 Placebo 19.79473
## 5     5 1   Herb2 23.46557
## 6     6 2    Cont 21.65736</code></pre>
<div id="the-dplyr-and-ggplot-pipeline-for-inference." class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> The dplyr and ggplot pipeline for inference.<a href="design-and-analysis-of-experiments.html#the-dplyr-and-ggplot-pipeline-for-inference." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can move to our standard data management and visualisation pipeline.</p>
<ol style="list-style-type: decimal">
<li>review the data (the <code>plantYield.csv</code> file contains the data)</li>
<li>sumamrise the data with dplyr - generate means and se’s for the treatments</li>
<li>visualise with ggplot2</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="design-and-analysis-of-experiments.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the data</span></span>
<span id="cb5-2"><a href="design-and-analysis-of-experiments.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note</span></span>
<span id="cb5-3"><a href="design-and-analysis-of-experiments.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># obs == yield</span></span>
<span id="cb5-4"><a href="design-and-analysis-of-experiments.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># treat == treatment</span></span>
<span id="cb5-5"><a href="design-and-analysis-of-experiments.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># r = replicate (there are 30 of each treatment)</span></span>
<span id="cb5-6"><a href="design-and-analysis-of-experiments.html#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="design-and-analysis-of-experiments.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(plantYield)</span></code></pre></div>
<pre><code>## Rows: 120
## Columns: 4
## $ plots &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 1…
## $ r     &lt;int&gt; 1, 2, 1, 3, 1, 2, 1, 2, 3, 4, 5, 4, 6, 5, 3, 2, 6, 7, 8, 4, 5, 3…
## $ treat &lt;chr&gt; &quot;Placebo&quot;, &quot;Placebo&quot;, &quot;Cont&quot;, &quot;Placebo&quot;, &quot;Herb2&quot;, &quot;Cont&quot;, &quot;Herb1…
## $ obs   &lt;dbl&gt; 27.54449, 22.39018, 18.23051, 19.79473, 23.46557, 21.65736, 26.5…</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="design-and-analysis-of-experiments.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s force treat to be a factor.  This will make life easier later...</span></span>
<span id="cb7-2"><a href="design-and-analysis-of-experiments.html#cb7-2" aria-hidden="true" tabindex="-1"></a>plantYield <span class="ot">&lt;-</span> plantYield <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="design-and-analysis-of-experiments.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">factor</span>(treat))</span>
<span id="cb7-4"><a href="design-and-analysis-of-experiments.html#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="design-and-analysis-of-experiments.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise to get means and ses</span></span>
<span id="cb7-6"><a href="design-and-analysis-of-experiments.html#cb7-6" aria-hidden="true" tabindex="-1"></a>sumDat <span class="ot">&lt;-</span> plantYield <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="design-and-analysis-of-experiments.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treat) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="design-and-analysis-of-experiments.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-9"><a href="design-and-analysis-of-experiments.html#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the means</span></span>
<span id="cb7-10"><a href="design-and-analysis-of-experiments.html#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanYield =</span> <span class="fu">mean</span>(obs),</span>
<span id="cb7-11"><a href="design-and-analysis-of-experiments.html#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the se</span></span>
<span id="cb7-12"><a href="design-and-analysis-of-experiments.html#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">seYield =</span> <span class="fu">sd</span>(obs)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>())</span>
<span id="cb7-13"><a href="design-and-analysis-of-experiments.html#cb7-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-14"><a href="design-and-analysis-of-experiments.html#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="design-and-analysis-of-experiments.html#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the raw data and the mean±se</span></span>
<span id="cb7-16"><a href="design-and-analysis-of-experiments.html#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># start with the mean±se and then add the raw data</span></span>
<span id="cb7-17"><a href="design-and-analysis-of-experiments.html#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumDat, <span class="fu">aes</span>(<span class="at">x =</span> treat, <span class="at">y =</span> meanYield))<span class="sc">+</span></span>
<span id="cb7-18"><a href="design-and-analysis-of-experiments.html#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb7-19"><a href="design-and-analysis-of-experiments.html#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> sumDat, <span class="fu">aes</span>(<span class="at">ymin =</span> meanYield <span class="sc">-</span> seYield, <span class="at">ymax =</span> meanYield<span class="sc">+</span>seYield),</span>
<span id="cb7-20"><a href="design-and-analysis-of-experiments.html#cb7-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb7-21"><a href="design-and-analysis-of-experiments.html#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> design, <span class="fu">aes</span>(<span class="at">x =</span> treat, <span class="at">y =</span> obs), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="Experimental-Design,-ANOVA-and-ANCOVA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>A few things to notice.</p>
<ol style="list-style-type: decimal">
<li>The data are quite variable and the means of the herbicide treatments are roughly 5 and 6 units higher than the control. GOOD. This is as we expected….</li>
<li>The standard errors are quite small, even though the variation is large! Why is that!?</li>
<li>The two herbicides don’t look very different, especially given the variation around each treatment. Neither do the placebo and control. We need some stats.</li>
<li>For those of you interested in some extra reading and thinking, the 95% Confidence Interval around the means can be calculated using <code>1.96*SE</code> == <code>1.96*sd(obs)/sqrt(n())</code>. Go ahead and do that and look into that if you want…</li>
</ol>
</div>
<div id="the-one-way-anova." class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> The One-Way ANOVA.<a href="design-and-analysis-of-experiments.html#the-one-way-anova." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you’ve been paying attention, we’ve essentially designed and plotted the data for a 1-way ANOVA. These data are very similar to the daphnia parasite data we finished semester 1 with.</p>
<p>To analyse these data, we use the <code>lm()</code> function to build the model, check assumptions, and then make inference. Let’s go.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="design-and-analysis-of-experiments.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the model</span></span>
<span id="cb8-2"><a href="design-and-analysis-of-experiments.html#cb8-2" aria-hidden="true" tabindex="-1"></a>modYield <span class="ot">&lt;-</span> <span class="fu">lm</span>(obs <span class="sc">~</span> treat, <span class="at">data =</span> plantYield)</span>
<span id="cb8-3"><a href="design-and-analysis-of-experiments.html#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="design-and-analysis-of-experiments.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># assumptions</span></span>
<span id="cb8-5"><a href="design-and-analysis-of-experiments.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(modYield)</span></code></pre></div>
<p><img src="Experimental-Design,-ANOVA-and-ANCOVA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="design-and-analysis-of-experiments.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inference: anova</span></span>
<span id="cb9-2"><a href="design-and-analysis-of-experiments.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modYield)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: obs
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## treat       3 807.49 269.164  33.257 1.383e-15 ***
## Residuals 116 938.85   8.094                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="design-and-analysis-of-experiments.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb11-2"><a href="design-and-analysis-of-experiments.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modYield)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = obs ~ treat, data = plantYield)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6952 -2.1542 -0.3872  1.8383  7.0609 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.0004     0.5194  38.506  &lt; 2e-16 ***
## treatHerb1     4.1655     0.7346   5.671 1.06e-07 ***
## treatHerb2     6.2449     0.7346   8.502 7.43e-14 ***
## treatPlacebo   0.4832     0.7346   0.658    0.512    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.845 on 116 degrees of freedom
## Multiple R-squared:  0.4624, Adjusted R-squared:  0.4485 
## F-statistic: 33.26 on 3 and 116 DF,  p-value: 1.383e-15</code></pre>
</div>
<div id="making-insight-and-inference" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Making insight and inference<a href="design-and-analysis-of-experiments.html#making-insight-and-inference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets walks through things very discretely.</p>
<ol style="list-style-type: decimal">
<li>Our graph suggests that herbicide treatments have an effect of increasing yield.</li>
<li>Our model is designed to test this hypothesis - are any of the differences among means non-zero?</li>
<li>Our hypothesis is probably really about whether the herbicide and placebos are different than the controls. All Hail the <em>treatment contrast</em>!</li>
<li>Our diagnostics are fantastic… the best you’ve ever seen.</li>
<li>The Anova Table confirms that there are differences - we can reject the null hypothesis</li>
<li>The summary table confirms that Herb1 and Herb2 are both larger than controls and the Placebo is not.</li>
</ol>
<p>How do we interpret even more?</p>
<p>The estimate associated with Control is 20! Just where it should be.</p>
<p>The estimates associated with Herb1, Herb2 and Placebo are the differences between the mean of these treatments and the control (the reference level!). These differences are positive for Herb1 and Herb2, close to 5 and 6 respectively (as expected) and this positive difference is not 0 via the statistical test.</p>
<p>However, the difference for Placebo is close to 0 and therefore we can not reject the null hypothesis test that it differs from control. GENUIS!</p>
</div>
</div>
<div id="a-priori-vs.-post-hoc-contrasts" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> A priori vs. Post-Hoc Contrasts<a href="design-and-analysis-of-experiments.html#a-priori-vs.-post-hoc-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we discussed above, there are likely several other questions we might have wanted to answer when designing this experiment. For example, are the two herbicides different in their effects?</p>
<div id="custom-contrasts-versus-the-tukey-test" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Custom contrasts versus the Tukey Test<a href="design-and-analysis-of-experiments.html#custom-contrasts-versus-the-tukey-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the semester 1, we introduced how to do a Tukey Test. This is known as an <em>a posteriori</em> test – testing the significance of things suggested by the experiment, also known as data snooping or data dredging. These are multiple comparison methods (Bonferroni, Scheffe method, Tukey honest significant difference, Duncan’s multiple range test) which try to control the chance of getting a significant result by chance.</p>
<p>To understand the risks of these, consider this experimental design. We have 7 treatments. With 7 treatments, there are 21 pairwise comparisons. With p-value threshold of <span class="math inline">\(0.05\)</span> we expect 1/20 (5/100) tests to be significant. So with this 7 treatment and 21 comparison design, would you expect a signficant result by chance? You betyja.</p>
<p>This is why, unless a priori (in advance) you can justify ALL pairwise comparisons, a Tukey Test may not be appropriate.</p>
<p>Some statisticians really don’t like them:</p>
<blockquote>
<p>“In my view multiple comparison methods have no place at all in the interpretation of data” -Nelder (a very very very well respected statistician).</p>
</blockquote>
<div id="the-more-appropriate-approach---custom-contrasts" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> The more appropriate approach - custom contrasts<a href="design-and-analysis-of-experiments.html#the-more-appropriate-approach---custom-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <em>more appropriate</em> approach is to specify <em>a priori</em> (before the experiment) a set of hypotheses you want to test, and then test them using contrasts.</p>
<p>For our experiment, as noted above, we were probably interested in what our treatment contrasts provided - tests of difference with the control. But we had a few others too.</p>
<p>Specifying specific contrasts is easy once you get your head around the ‘structure’ of the syntax.</p>
<p>Lets have a go with specifying a comparison JUST between Herbicide 1 and the control. Remember that your model is called <code>modYield</code> and your data is called <code>design</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="design-and-analysis-of-experiments.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the levels and ORDERING of the treatments</span></span>
<span id="cb13-2"><a href="design-and-analysis-of-experiments.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this function, levels(), tells you this</span></span>
<span id="cb13-3"><a href="design-and-analysis-of-experiments.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># note the ORDER: it is alphabetical, and control comes first</span></span>
<span id="cb13-4"><a href="design-and-analysis-of-experiments.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the words fill in four slots c(X,X,X,X). </span></span>
<span id="cb13-5"><a href="design-and-analysis-of-experiments.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we will use these slots....</span></span>
<span id="cb13-6"><a href="design-and-analysis-of-experiments.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(plantYield<span class="sc">$</span>treat)</span></code></pre></div>
<pre><code>## [1] &quot;Cont&quot;    &quot;Herb1&quot;   &quot;Herb2&quot;   &quot;Placebo&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="design-and-analysis-of-experiments.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the contrast you want using -1, 1 and 0&#39;s</span></span>
<span id="cb15-2"><a href="design-and-analysis-of-experiments.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this says compare control with herbicide 1.... and ignore the Herb2 and Placebo</span></span>
<span id="cb15-3"><a href="design-and-analysis-of-experiments.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we give the reference -1 to the control slot</span></span>
<span id="cb15-4"><a href="design-and-analysis-of-experiments.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and the reference 1 to the Herbicide 1 slot.</span></span>
<span id="cb15-5"><a href="design-and-analysis-of-experiments.html#cb15-5" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb15-6"><a href="design-and-analysis-of-experiments.html#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="design-and-analysis-of-experiments.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># use the fit.contrast function from gmodels</span></span>
<span id="cb15-8"><a href="design-and-analysis-of-experiments.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(modYield, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                      Estimate Std. Error t value     Pr(&gt;|t|)
## treat c=( -1 1 0 0 ) 4.165507   0.734555 5.67079 1.058335e-07
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<p>So, this says that the difference between the control and Herbicide 1 is ~5 and that this is different from 0. Does that number <code>4.16</code> look familiar? It should. It is the same number from the <code>summary()</code> table of the full model. This is because we just specified one of the three treatment contrasts that <code>summary()</code> uses.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="design-and-analysis-of-experiments.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remind ourselves of the contrast from the summary table</span></span>
<span id="cb17-2"><a href="design-and-analysis-of-experiments.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modYield)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = obs ~ treat, data = plantYield)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6952 -2.1542 -0.3872  1.8383  7.0609 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.0004     0.5194  38.506  &lt; 2e-16 ***
## treatHerb1     4.1655     0.7346   5.671 1.06e-07 ***
## treatHerb2     6.2449     0.7346   8.502 7.43e-14 ***
## treatPlacebo   0.4832     0.7346   0.658    0.512    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.845 on 116 degrees of freedom
## Multiple R-squared:  0.4624, Adjusted R-squared:  0.4485 
## F-statistic: 33.26 on 3 and 116 DF,  p-value: 1.383e-15</code></pre>
</div>
<div id="a-different-contrast---herbicide-1-vs-herbicide-2." class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> A different contrast - Herbicide 1 vs Herbicide 2.<a href="design-and-analysis-of-experiments.html#a-different-contrast---herbicide-1-vs-herbicide-2." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we want to compare the two herbicides we can use this approach. Note in advance that this contrast DOES NOT exist in the summary table!</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="design-and-analysis-of-experiments.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the contrast you want using -1, 1 and 0&#39;s</span></span>
<span id="cb19-2"><a href="design-and-analysis-of-experiments.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this says compare herb1 with herb2, ignoring the control and placebo.</span></span>
<span id="cb19-3"><a href="design-and-analysis-of-experiments.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we give the slot for herbicide 1 a &quot;-1&quot; and the slot for herbicide 2 a &quot;1&quot;.</span></span>
<span id="cb19-4"><a href="design-and-analysis-of-experiments.html#cb19-4" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb19-5"><a href="design-and-analysis-of-experiments.html#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="design-and-analysis-of-experiments.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the fit.contrast function from gmodels</span></span>
<span id="cb19-7"><a href="design-and-analysis-of-experiments.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(modYield, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                      Estimate Std. Error  t value    Pr(&gt;|t|)
## treat c=( 0 -1 1 0 ) 2.079439   0.734555 2.830882 0.005473189
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<p>Isn’t this cool? And quite surprising, right? We did not expect this. This says that despite the difference we created of ~1 unit of yield between Herb1 and Herb2, and even with the big variation, the statistics detect a significant difference.</p>
<p>Note that the difference reported is the difference between the two means that we calcuated from the sumDat calculation above!:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="design-and-analysis-of-experiments.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check our summary data</span></span>
<span id="cb21-2"><a href="design-and-analysis-of-experiments.html#cb21-2" aria-hidden="true" tabindex="-1"></a>sumDat</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   treat   meanYield seYield
##   &lt;fct&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Cont         20.0   0.552
## 2 Herb1        24.2   0.591
## 3 Herb2        26.2   0.359
## 4 Placebo      20.5   0.544</code></pre>
<p>Here it is: <span class="math inline">\(26.2 - 24.2 = 2\)</span></p>
</div>
<div id="a-more-complex-contrast-comparing-the-average-of-the-herbicide-effect-with-the-control." class="section level4 hasAnchor" number="4.2.1.3">
<h4><span class="header-section-number">4.2.1.3</span> A more complex contrast: comparing the average of the herbicide effect with the control.<a href="design-and-analysis-of-experiments.html#a-more-complex-contrast-comparing-the-average-of-the-herbicide-effect-with-the-control." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This might be a comparison you intended to make also… the average effect of herbicides in general. To do this, we expand the idea of -1,1 and 0’s to include 1/2s (yes, 1/3’s and more are possible):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="design-and-analysis-of-experiments.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the contrast you want using -1, 1 and 0&#39;s</span></span>
<span id="cb23-2"><a href="design-and-analysis-of-experiments.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this says compare control with the average of herbicide 1 and 2, ignoring the placebo</span></span>
<span id="cb23-3"><a href="design-and-analysis-of-experiments.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we give the control slot a -1 and the two herbicide slots a 1/2 each.</span></span>
<span id="cb23-4"><a href="design-and-analysis-of-experiments.html#cb23-4" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb23-5"><a href="design-and-analysis-of-experiments.html#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="design-and-analysis-of-experiments.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the fit.contrast function from gmodels</span></span>
<span id="cb23-7"><a href="design-and-analysis-of-experiments.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(modYield, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                          Estimate Std. Error  t value     Pr(&gt;|t|)
## treat c=( -1 0.5 0.5 0 ) 5.205226  0.6361433 8.182475 4.015904e-13
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<p>How very cool. This custom contrast delivers the inference that herbicides on average increase yield by five units.</p>
<p>Again, checking sumDat, we can see where this result comes from.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="design-and-analysis-of-experiments.html#cb25-1" aria-hidden="true" tabindex="-1"></a>sumDat</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   treat   meanYield seYield
##   &lt;fct&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Cont         20.0   0.552
## 2 Herb1        24.2   0.591
## 3 Herb2        26.2   0.359
## 4 Placebo      20.5   0.544</code></pre>
<p><span class="math inline">\((24.2+26.2)/2 = 25.2\)</span> –&gt; <span class="math inline">\(25.2 - 20 = 5.2\)</span></p>
</div>
</div>
<div id="the-write-up-using-contrasts." class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> The Write Up using contrasts.<a href="design-and-analysis-of-experiments.html#the-write-up-using-contrasts." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fill in these blanks using the various contrasts you made above!</p>
<blockquote>
<p>We conclude that herbicides on average cause an _____ gram increase in yield (t = ___ , p = ___ ). We also note that there was a significant difference of _____ grams between the herbicides (t = _____ p = ______). The additional placebo treatment had no effect on yield (t = _______ p = __________).</p>
</blockquote>
</div>
<div id="coming-back-to-randomisation" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Coming Back to Randomisation<a href="design-and-analysis-of-experiments.html#coming-back-to-randomisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have worked here with a CRD where the measurement units are completely randomised to the experimental treatments. This simple effort is super valuable. As you’ve read.</p>
<blockquote>
<p>Randomisation guards against a variety of possible biases and confounding effects, including the inadvertent biases that might be introduced simply in the process of setting up an experiment…. Randomisation is a critical method for guarding against confounding effects. It is the best insurance we have against unwittingly getting some other factor working in parallel to a treatment.</p>
</blockquote>
<p>But what if we know there is a gradient, or a feature of the environment or lab system that we KNOW could confound the design. Is there any way we can remove this known pattern? Yes…. of course there is.</p>
</div>
</div>
<div id="the-rcbd---the-randomised-complete-block-design" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> THE RCBD - The Randomised Complete Block Design<a href="design-and-analysis-of-experiments.html#the-rcbd---the-randomised-complete-block-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Blocking allows us to reduce known experimental error.</p>
<p>A block is a group of experimental units that are homogeneous in some sense – in the same place, or measured at the same time, or by the same person. They may experience a similar temperature, or hormone concentration. They may simply be a position in the incubator where light varies from front to back.</p>
<p>So when constructing blocks we try and select experimental units that are homogeneous within blocks but where the blocks, and thus units within them, may be dissimilar.</p>
<p>Why block? When we use a completely randomised design, the location or timing of our treatment ‘plots’ (patches with different N or soil-moisture, incubators, locations in a 96 well plate) can generate <em>heterogeneity</em> in experimental error (variation).</p>
<p>This has consequences for our ability to detect effects. As the variance of the Experimental Error increases, confidence intervals get wider and the power of our analysis decreases - it’s harder to detect effects of our treatments against the background noise. Ideally we would like to use experimental units that are homogeneous so the experimental error will be small. Blocking does this.</p>
<p>The simplest blocked design is the <strong>Randomized Complete Block design (RCB)</strong></p>
<p>We have one complete set of treatments in each block. For the sake of example, lets imagine we identify three ‘blocks’ - soil moisture zones. In the design above, we would allocate 10/30 replicates of each treatment to each block.</p>
<p>In the first block, we randomly assign the 10 treatments to n locations in the block. We do an <em>independent randomization</em> in each block. This is the RCB design.</p>
<p>For example, consider the following matrix: the rows are the blocks, the letters the different treatments. In each block, each treatment is represented, but it is in a different location in the block (randomisation of the g treatments in the n units). The blocks are in a sequence - left to right - this could be different days, different locations or different positions on a hillside, for example representing an elevation or soil moisture gradient.</p>
<p>The Blocks are designed to ‘capture’ that underlying source of variability and allow us to detect among treatment differences more effectively.</p>
<p>For example, consider the following matrix: the rows are the blocks, the letters the different treatments. In each block, each treatment is represented, but it is in a different location in the block (randomisation of the g treatments in the n units). The blocks are in a sequence - left to right - this could be different days, different locations or different positions on a hillside, for example representing an elevation or soil moisture gradient.</p>
<p>The Blocks are designed to ‘capture’ that underlying source of variability and allow us to detect among treatment differences more effectively.</p>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,] &quot;A&quot;  &quot;B&quot;  &quot;A&quot;  &quot;E&quot;  &quot;D&quot; 
## [2,] &quot;C&quot;  &quot;A&quot;  &quot;D&quot;  &quot;C&quot;  &quot;A&quot; 
## [3,] &quot;D&quot;  &quot;E&quot;  &quot;B&quot;  &quot;D&quot;  &quot;C&quot; 
## [4,] &quot;E&quot;  &quot;C&quot;  &quot;E&quot;  &quot;B&quot;  &quot;E&quot; 
## [5,] &quot;B&quot;  &quot;D&quot;  &quot;C&quot;  &quot;A&quot;  &quot;B&quot;</code></pre>
<p>Here is another picture of a block design that moves from just letters to something more literal.</p>
<p><img src="images/BlockDesignGraphic.png" width="320" /></p>
<p>The blocks are arranged along a gradient, say along the side of a hill, so represent low and high elevation and associated soil moisture. The blocks capture this background variation. THEN, each treatment level (1-4) is allocated a random position in each block.  In the end, each treatment level is replicated across blocks (n = 6!). From: <a href="https://www.researchgate.net/publication/322369242_Randomized_Block_Design_probiotic_example/figures?lo=1" class="uri">https://www.researchgate.net/publication/322369242_Randomized_Block_Design_probiotic_example/figures?lo=1</a></p>
<p>It is important to note that blocks exist at the time of the randomization of treatments to units. We cannot impose blocking structure on a completely randomized design after the fact; either the randomization was blocked or it was not.</p>
<p>We use an RCB to increase the power and precision of an experiment by decreasing the error variance. This decrease in error variance is achieved by finding groups of units that are homogeneous (blocks) and, in effect, repeating the experiment independently in the different blocks. The RCB is an effective design when there is a single source of extraneous variation in the responses that we can identify ahead of time and use to partition the units into blocks.</p>
<p>In short ALWAYS block your experiment, if you can.</p>
<p>You can have spatial blocks, or temporal blocks where you repeat the experiment at different times, or block by batch.</p>
<p>In general, any source of variation that you think may influence the response and which can be identified prior to the experiment is a candidate for blocking.</p>
</div>
<div id="an-example-of-the-rcbd" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> An example of the RCBD<a href="design-and-analysis-of-experiments.html#an-example-of-the-rcbd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lets modify our previous example to including blocking. If you wish to replicate the analysis, the data are <code>plantYield_Blocked.csv</code>.</p>
<pre><code>##    plots block   treat      obs
## 1     11     1 Placebo 31.18707
## 2     12     1 Control 31.99603
## 3     13     1   Herb2 41.29937
## 4     14     1   Herb1 41.12746
## 5     21     2 Control 21.08111
## 6     22     2   Herb1 30.56917
## 7     23     2   Herb2 28.09290
## 8     24     2 Placebo 21.02990
## 9     31     3   Herb2 27.44097
## 10    32     3   Herb1 30.29749</code></pre>
</div>
<div id="analysing-the-crbd" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Analysing the CRBD<a href="design-and-analysis-of-experiments.html#analysing-the-crbd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I’ll leave it to you now to generate the following plot of the means ± standard errors.</p>
<p>This requires thinking hard about the use of dplyr tools (<code>group_by()</code> and <code>summarise()</code>) and ggplot (adding more than one layer from two different sources of data - the summary data and the raw data). You need to make a <em>sumDat</em> object for the means and se’s. Then you need to plot the raw data, and overlay the mean±se info from the sumDat.</p>
<p>Can you see the variation between block 1 and 5? Block 2-4 are all similar…. Block 1 is 10 units more, and Block 5 is 10 units less.</p>
<pre><code>## Rows: 20
## Columns: 4
## $ plots &lt;dbl&gt; 11, 12, 13, 14, 21, 22, 23, 24, 31, 32, 33, 34, 41, 42, 43, 44, …
## $ block &lt;fct&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5
## $ treat &lt;fct&gt; Placebo, Control, Herb2, Herb1, Control, Herb1, Herb2, Placebo, …
## $ obs   &lt;dbl&gt; 31.18707, 31.99603, 41.29937, 41.12746, 21.08111, 30.56917, 28.0…</code></pre>
<p><img src="Experimental-Design,-ANOVA-and-ANCOVA_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div id="building-the-model" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Building the model<a href="design-and-analysis-of-experiments.html#building-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to understand what’s going on with blocking, and it’s importance, lets build the naive model that ignores block - treating this as a CRB - and the correct model, letting block absorb some of the variation.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="design-and-analysis-of-experiments.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># models</span></span>
<span id="cb30-2"><a href="design-and-analysis-of-experiments.html#cb30-2" aria-hidden="true" tabindex="-1"></a>naive_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(obs <span class="sc">~</span> treat, plantYield_Block)</span>
<span id="cb30-3"><a href="design-and-analysis-of-experiments.html#cb30-3" aria-hidden="true" tabindex="-1"></a>block_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(obs <span class="sc">~</span> block <span class="sc">+</span> treat, plantYield_Block) <span class="co"># note the order is important</span></span>
<span id="cb30-4"><a href="design-and-analysis-of-experiments.html#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="design-and-analysis-of-experiments.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova tables</span></span>
<span id="cb30-6"><a href="design-and-analysis-of-experiments.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(naive_model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: obs
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## treat      3 417.82 139.274  2.5085 0.09579 .
## Residuals 16 888.34  55.521                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="design-and-analysis-of-experiments.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(block_model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: obs
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## block      4 877.08 219.270  233.68 2.871e-11 ***
## treat      3 417.82 139.274  148.43 9.469e-10 ***
## Residuals 12  11.26   0.938                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The first important thing to focus on here is the difference in the Mean Sq Residual Errors - in the <code>naive_model</code>, it is <span class="math inline">\(55.52\)</span>. In the <code>block_model</code>, it is <span class="math inline">\(0.94\)</span>.</p>
<p>The second important thing to notice is that haveing allocated variation to block in the <code>block_model</code>, and thus reducing the error variation, the <em>treatment</em> effect shifts from being insignificant to significant.</p>
</div>
<div id="are-the-estimates-of-the-parameters-what-we-expect" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Are the estimates of the parameters what we expect?<a href="design-and-analysis-of-experiments.html#are-the-estimates-of-the-parameters-what-we-expect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets check that the model is estimating differences as we might have expected. We can do this using the summary table.</p>
<p>Let’s remember that, for example, the mean of Herb1 is expected to be 10 units higher than control with a yield of 20, and block 1 is supposed to be ~10 units higher than 2,3,4.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="design-and-analysis-of-experiments.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(block_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = obs ~ block + treat, data = plantYield_Block)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.3505 -0.7196  0.2147  0.6396  1.0719 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   31.2184     0.6126  50.957 2.14e-15 ***
## block2       -11.2092     0.6850 -16.365 1.43e-09 ***
## block3       -12.1132     0.6850 -17.685 5.84e-10 ***
## block4       -11.3415     0.6850 -16.558 1.25e-09 ***
## block5       -20.8449     0.6850 -30.433 9.94e-13 ***
## treatHerb1    10.3450     0.6126  16.886 9.96e-10 ***
## treatHerb2     9.0721     0.6126  14.808 4.50e-09 ***
## treatPlacebo   1.3192     0.6126   2.153   0.0523 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9687 on 12 degrees of freedom
## Multiple R-squared:  0.9914, Adjusted R-squared:  0.9864 
## F-statistic: 197.1 on 7 and 12 DF,  p-value: 2.009e-11</code></pre>
<p>In this table, the <em>INTERCEPT</em> is specifying the <strong>FIRST BLOCK</strong> and the <strong>CONTROL TREATMENT LEVEL</strong> - we know this because it’s these words that are missing from the rest of the table, and they are each the first alphanumerially in the list of blocks and treatments.</p>
<p>The value of the control, block 1 is approximately 30! Which is 20+10, which is what we expected.
The value of Herb1 is ~10 units higher than this (remember, the value 9.84 is the DIFFERENCE between the control and treatment)
And the value of block 5 is reported as 20 unites lower than block 1 control. This too is correct because, as above, block 1 control is 10 units higher than the control mean (20+10) and block 5 is 10 units lower….</p>
<p><em>Make sure you get this logic!</em></p>
<p>The take home message here is that these numbers from the model make complete sense with respect to the data that we simulated. Furthermore, controlling for the among block variation gave us more power to detect a treatment effect, something we would have missed had we not estimated the block source of variation.</p>
</div>
<div id="correct-standard-errors-for-a-figure" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Correct Standard Errors for a Figure<a href="design-and-analysis-of-experiments.html#correct-standard-errors-for-a-figure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we made our initial plot above, we calculated the standard error based on all observations among blocks. However, the variation we really wish to represent is the variation after having controlled for the blocking effects.</p>
<p>This means that the standard deviation we should probably use is of the error variance from the correct model: <span class="math inline">\(0.94\)</span>.</p>
<p>The standard deviation is the <span class="math inline">\(\sqrt{Var}\)</span> and thus, our correct standard errors from the model are <span class="math inline">\(\sqrt{0.94}\)</span></p>
<p>There is a very nice plotting function in the package <em>visreg</em> that delivers these proper standard errors in a nice ggplot framework. It presents points that are the partial residuals (deviation from the mean for each replicate), lines depicting the means, and shaded area as a 95% confidence interval, calculated as 1.96*SE, where the SE is estimated from the model error variance (just above). Compare this to your first graph.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="design-and-analysis-of-experiments.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(block_model, <span class="st">&quot;treat&quot;</span>, <span class="at">gg=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb36-2"><a href="design-and-analysis-of-experiments.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span> </span>
<span id="cb36-3"><a href="design-and-analysis-of-experiments.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Treatment&quot;</span>) </span></code></pre></div>
<p><img src="Experimental-Design,-ANOVA-and-ANCOVA_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="making-inference-confidence-intervals-and-contrasts" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Making inference: confidence intervals and contrasts<a href="design-and-analysis-of-experiments.html#making-inference-confidence-intervals-and-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are now in a very strong position to make inference.</p>
<p>Let’s start with a rule of thumb linked to the 95% confidence interval. If the CIs don’t overlap, they are different; if they do, they are not. This indicates that Cont and Placebo are not significantly different (95% confidence intervals overlap). Herb1 and Herb 2 are significantly different from these, but not each other.</p>
<p>This is OK. But it’s not robust. Let’s revisit our <em>post-hoc</em> and <em>a priori</em> methods for evaluating differnces among treatments. We can apply a tukey test and calculate all pairwise differences. This is not a good idea, but let’s do it.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="design-and-analysis-of-experiments.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use agricolae HSD.test()</span></span>
<span id="cb37-2"><a href="design-and-analysis-of-experiments.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="design-and-analysis-of-experiments.html#cb37-3" aria-hidden="true" tabindex="-1"></a>tukey_out <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(block_model, <span class="st">&quot;treat&quot;</span>, <span class="at">group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-4"><a href="design-and-analysis-of-experiments.html#cb37-4" aria-hidden="true" tabindex="-1"></a>tukey_out<span class="sc">$</span>groups</span></code></pre></div>
<pre><code>##              obs groups
## Herb1   30.46167      a
## Herb2   29.18874      a
## Placebo 21.43581      b
## Control 20.11665      b</code></pre>
<p>This confirms our intuition and 95% Confidence Interval insights. But is it correct?</p>
<p>Let’s make a formal test of one of the pairwise tests that looks obvious - between Herb1 and Herb2</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="design-and-analysis-of-experiments.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit.contrast from gmodels package</span></span>
<span id="cb39-2"><a href="design-and-analysis-of-experiments.html#cb39-2" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb39-3"><a href="design-and-analysis-of-experiments.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fit.contrast</span>(block_model, <span class="st">&quot;treat&quot;</span>, contrast)</span></code></pre></div>
<pre><code>##                       Estimate Std. Error   t value   Pr(&gt;|t|)
## treat c=( 0 -1 1 0 ) -1.272934  0.6126423 -2.077777 0.05985811
## attr(,&quot;class&quot;)
## [1] &quot;fit_contrast&quot;</code></pre>
<p>Amazing. The contrast defining a specific test provides a different answer than the post-hoc Tukey test and our guess based on the 95% CIs. Why is that? Which is right?</p>
<p>Of course the contrast is the correct and most reliable result. While both <em>fit.contrast</em> and <em>HSD.test</em> both manage the model complexity and variance estimates properly, only the contrast reduces the probability of finding a significant difference by chance or failing to find one.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="examples-and-challenge-questions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="randomized-complete-block-design-rcb.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-Complete_and_Blocked_Designs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Experimental Design, ANOVA and ANCOVA.pdf", "Experimental Design, ANOVA and ANCOVA.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
