<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Designs for testing for interactions: the two-way ANOVA and factorial designs. | An Introduction to Experimental Design ANOVA and ANCOVA</title>
  <meta name="description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Designs for testing for interactions: the two-way ANOVA and factorial designs. | An Introduction to Experimental Design ANOVA and ANCOVA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Designs for testing for interactions: the two-way ANOVA and factorial designs. | An Introduction to Experimental Design ANOVA and ANCOVA" />
  
  <meta name="twitter:description" content="This is an introduction to Experimental Design, ANOVA and ANCOVA analyses." />
  

<meta name="author" content="Andrew P Beckerman (with support from text and slides from Mark Rees and Gareth Phoenix)" />


<meta name="date" content="2022-12-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="design-and-analysis-of-experiments.html"/>
<link rel="next" href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Experimental Design, ANOVA and ANCOVA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-three-rs-the-foundation-of-experimental-design."><i class="fa fa-check"></i><b>1.1</b> The Three Rs: The Foundation of Experimental Design.</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-general-linear-model"><i class="fa fa-check"></i><b>1.2</b> The General Linear Model</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="readings--.html"><a href="readings--.html"><i class="fa fa-check"></i><b>2</b> Readings —-</a>
<ul>
<li class="chapter" data-level="2.1" data-path="readings--.html"><a href="readings--.html#install-some-extra-packages--"><i class="fa fa-check"></i><b>2.1</b> Install some extra packages —-</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html"><i class="fa fa-check"></i><b>3</b> Introduction To Experimental Design</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#conepts-associated-with-causation"><i class="fa fa-check"></i><b>3.1</b> Conepts associated with causation</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#components-of-an-experiment"><i class="fa fa-check"></i><b>3.2</b> Components of an Experiment</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#the-holy-grail-of-a-control"><i class="fa fa-check"></i><b>3.3</b> The holy grail of a control</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#so-what-does-a-good-experimental-design-do"><i class="fa fa-check"></i><b>3.4</b> So what does a good experimental design do?</a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#how-do-we-increase-precision-and-reduce-bias"><i class="fa fa-check"></i><b>3.5</b> How do we increase precision and reduce bias?</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#blinding"><i class="fa fa-check"></i><b>3.5.1</b> Blinding</a></li>
<li class="chapter" data-level="3.5.2" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#placebos"><i class="fa fa-check"></i><b>3.5.2</b> Placebos</a></li>
<li class="chapter" data-level="3.5.3" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#confounders"><i class="fa fa-check"></i><b>3.5.3</b> Confounders</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#experimental-vs.-measurement-units"><i class="fa fa-check"></i><b>3.6</b> Experimental vs. Measurement units</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#experimental-and-measurement-units-an-example"><i class="fa fa-check"></i><b>3.6.1</b> Experimental and measurement units: an example</a></li>
<li class="chapter" data-level="3.6.2" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#identifying-the-experimental-unit---an-example-of-pseudo-replication"><i class="fa fa-check"></i><b>3.6.2</b> Identifying the experimental unit - an example of <strong>pseudo-replication</strong></a></li>
<li class="chapter" data-level="3.6.3" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#psudo-replication"><i class="fa fa-check"></i><b>3.6.3</b> Psudo-replication</a></li>
<li class="chapter" data-level="3.6.4" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#randomization-with-replication-protects-against-confounding"><i class="fa fa-check"></i><b>3.6.4</b> Randomization with Replication protects against Confounding</a></li>
<li class="chapter" data-level="3.6.5" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#haphazard-is-not-randomized---beware-the-non-randomized-experiment"><i class="fa fa-check"></i><b>3.6.5</b> <strong>haphazard</strong> is NOT randomized - beware the non-randomized experiment –</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#mini-quiz"><i class="fa fa-check"></i><b>3.7</b> Mini-Quiz</a></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-experimental-design.html"><a href="introduction-to-experimental-design.html#replication-how-many"><i class="fa fa-check"></i><b>3.8</b> Replication: How many?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html"><i class="fa fa-check"></i><b>4</b> Examples and Challenge Questions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="examples-and-challenge-questions.html"><a href="examples-and-challenge-questions.html#designing-your-first-experiment"><i class="fa fa-check"></i><b>4.1</b> Designing your first experiment</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html"><i class="fa fa-check"></i><b>5</b> Design and Analysis of Experiments</a>
<ul>
<li class="chapter" data-level="5.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#a-crd-completely-randomised-design-example"><i class="fa fa-check"></i><b>5.1</b> A CRD (Completely Randomised Design) Example</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-dplyr-and-ggplot-pipeline-for-inference."><i class="fa fa-check"></i><b>5.1.1</b> The dplyr and ggplot pipeline for inference.</a></li>
<li class="chapter" data-level="5.1.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-one-way-anova."><i class="fa fa-check"></i><b>5.1.2</b> The One-Way ANOVA.</a></li>
<li class="chapter" data-level="5.1.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#making-insight-and-inference"><i class="fa fa-check"></i><b>5.1.3</b> Making insight and inference</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#a-priori-vs.-post-hoc-contrasts"><i class="fa fa-check"></i><b>5.2</b> A priori vs. Post-Hoc Contrasts</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#custom-contrasts-versus-the-tukey-test"><i class="fa fa-check"></i><b>5.2.1</b> Custom contrasts versus the Tukey Test</a></li>
<li class="chapter" data-level="5.2.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-write-up-using-contrasts."><i class="fa fa-check"></i><b>5.2.2</b> The Write Up using contrasts.</a></li>
<li class="chapter" data-level="5.2.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#coming-back-to-randomisation"><i class="fa fa-check"></i><b>5.2.3</b> Coming Back to Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#the-rcbd---the-randomised-complete-block-design"><i class="fa fa-check"></i><b>5.3</b> THE RCBD - The Randomised Complete Block Design</a></li>
<li class="chapter" data-level="5.4" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#an-example-of-the-rcbd"><i class="fa fa-check"></i><b>5.4</b> An example of the RCBD</a></li>
<li class="chapter" data-level="5.5" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#analysing-the-crbd"><i class="fa fa-check"></i><b>5.5</b> Analysing the CRBD</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#building-the-model"><i class="fa fa-check"></i><b>5.5.1</b> Building the model</a></li>
<li class="chapter" data-level="5.5.2" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#are-the-estimates-of-the-parameters-what-we-expect"><i class="fa fa-check"></i><b>5.5.2</b> Are the estimates of the parameters what we expect?</a></li>
<li class="chapter" data-level="5.5.3" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#correct-standard-errors-for-a-figure"><i class="fa fa-check"></i><b>5.5.3</b> Correct Standard Errors for a Figure</a></li>
<li class="chapter" data-level="5.5.4" data-path="design-and-analysis-of-experiments.html"><a href="design-and-analysis-of-experiments.html#making-inference-in-a-blocked-model-confidence-intervals-and-contrasts"><i class="fa fa-check"></i><b>5.5.4</b> Making inference in a blocked model: confidence intervals and contrasts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><i class="fa fa-check"></i><b>6</b> Designs for testing for interactions: the two-way ANOVA and factorial designs.</a>
<ul>
<li class="chapter" data-level="6.1" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#introducing-interactions"><i class="fa fa-check"></i><b>6.1</b> Introducing Interactions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#an-example-with-co2-and-uv-b-solar-radiation-impact-on-plant-growth-in-the-artic."><i class="fa fa-check"></i><b>6.1.1</b> An Example with CO2 and UV-B solar radiation impact on plant growth in the artic.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#a-factorial-design-and-the-two-way-anova"><i class="fa fa-check"></i><b>6.2</b> A Factorial Design and the Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#plot-the-factorial-design"><i class="fa fa-check"></i><b>6.2.1</b> Plot the factorial design!</a></li>
<li class="chapter" data-level="6.2.2" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#how-to-analyse-and-interpret-the-factorial-design"><i class="fa fa-check"></i><b>6.2.2</b> How to analyse and interpret the factorial design</a></li>
<li class="chapter" data-level="6.2.3" data-path="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#visreg-and-the-2-way-anova"><i class="fa fa-check"></i><b>6.2.3</b> visreg and the 2-way ANOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><i class="fa fa-check"></i><b>7</b> Interactions Part 2: Introducing the ANCOVA (analysis of covariance)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#what-this-chapter-covers."><i class="fa fa-check"></i><b>7.1</b> What this chapter covers.</a></li>
<li class="chapter" data-level="7.2" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#setting-up-the-various-ideas."><i class="fa fa-check"></i><b>7.2</b> Setting up the various ideas.</a></li>
<li class="chapter" data-level="7.3" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#working-through-and-example."><i class="fa fa-check"></i><b>7.3</b> Working through and example.</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#get-the-data-and-make-your-picture"><i class="fa fa-check"></i><b>7.3.1</b> Get the data and make your picture</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#building-the-model-and-understanding-it"><i class="fa fa-check"></i><b>7.4</b> Building the model (and understanding it)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#dealing-with-some-issues-with-residuals."><i class="fa fa-check"></i><b>7.4.1</b> Dealing with some issues with residuals.</a></li>
<li class="chapter" data-level="7.4.2" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#making-inference-on-the-ancova"><i class="fa fa-check"></i><b>7.4.2</b> Making inference on the ANCOVA</a></li>
<li class="chapter" data-level="7.4.3" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#the-summary-table-the-actual-slopes-and-making-sense-of-the-log-stuff."><i class="fa fa-check"></i><b>7.4.3</b> The summary table, the actual slopes and making sense of the log stuff.</a></li>
<li class="chapter" data-level="7.4.4" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#the-equations-supported-by-the-model."><i class="fa fa-check"></i><b>7.4.4</b> The equations supported by the model.</a></li>
<li class="chapter" data-level="7.4.5" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#making-even-more-inference-and-drawing-the-picture"><i class="fa fa-check"></i><b>7.4.5</b> Making even more inference and drawing the picture</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#some-general-principles"><i class="fa fa-check"></i><b>7.5</b> Some General Principles</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#ancova-always-tests-the-interaction-against-the-additive-model"><i class="fa fa-check"></i><b>7.5.1</b> ANCOVA always tests the interaction against the additive model</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html"><a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html#a-few-parting-tricks-about-specifying-models-in-r"><i class="fa fa-check"></i><b>7.6</b> A few parting tricks about specifying models in R</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Experimental Design ANOVA and ANCOVA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs." class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Designs for testing for interactions: the two-way ANOVA and factorial designs.<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs." class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducing-interactions" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introducing Interactions<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#introducing-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous sections, and the 1-way ANOVA module in week 7, we have focused on a single explanatory variable. In week 7, it was the <code>parasite</code> factor. In the previous chapters focusing on yield, it was the <code>herbicide</code> treatment. In these cases, the question we are asking is about a single, main effect. However, there are many cases where we design experiments that might have two variables. For example, we may be interesting in the effect of <code>parasite</code> on growth but also whether this effect varies by the amount of food available. Or we might be interested in the yeild of a crop as a function of the herbicide, but also of soil water content. Or we might be interested in the rate of cell division as a function of a growth hormon, but also of whether this varies by the presence of a calcium blocker. In all of these cases we are asking a question about whether the effect of one treatment varies by the level of another. Thus, our question here is about an <em>interaction</em>.</p>
<p>Before jumping into an example, let’s introduce a simple statement that forms the core of both asking and interpreting <em>interactions</em>.</p>
<p>If there is an interaction between two explanatory variables, X and Z, on our response variable Y, then:</p>
<blockquote>
<p>The effect of X on Y varies by Z. <strong>OR</strong> The effect of X on Y depends on Z.</p>
</blockquote>
<p>This use of <em>varies by</em> <strong>OR</strong> <em>depends on</em> defines context dependency and that’s what defines interactions.</p>
<div id="an-example-with-co2-and-uv-b-solar-radiation-impact-on-plant-growth-in-the-artic." class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> An Example with CO2 and UV-B solar radiation impact on plant growth in the artic.<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#an-example-with-co2-and-uv-b-solar-radiation-impact-on-plant-growth-in-the-artic." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Context: an arctic tundra study
Increasing ultraviolet-B (+UV-B) radiation from ozone depletion (the arctic ozone hole)
Increasing atmospheric CO2 (+CO2) from anthropogenic emissions
For plants: UV-B potentially harmful, +CO2 potentially beneficial
Therefore +CO2 could alleviate UV-B damage impacts.</p>
<p><em>Hypothesis</em></p>
<p>The effect of UV-B radiation on growth will depend on levels of CO2</p>
<p><em>Predictions</em>:</p>
<p>+UV-B radiation will reduce the growth of arctic plants
+CO2 will increase the growth of arctic plants
+UV-B radiation impacts will be less under +CO2</p>
<p>What is unique about this context, hypothesis, and predictions?</p>
<p>It’s the presentation of CO2 and UVB in the same statement and the use of words like “the effect of X will alleviate the impacts of Y” and words like “the effects of X will be less under Y”. These words and phrases reflect the <em>context dependency</em> of the effects of treatment levels.</p>
<p>Thus, to restate what we introduced above…. when we talk about <em>interactions</em>, we can rely on a very simple vocabulary that is independent of the actual treatment levels: we can always describe an interaction like this:</p>
<blockquote>
<p>The effect of X on Y depends on Z.</p>
</blockquote>
<p>or</p>
<blockquote>
<p>The effect of X on Y varies by Z.</p>
</blockquote>
<p>In this ‘rubric’, Y is the response variable, and X and Z are explanatory, independent variables. So, in our example above,</p>
<blockquote>
<p>the effect of CO2 on plant biomass yield depends on UV-B radiation levels.</p>
</blockquote>
<p>OR</p>
<blockquote>
<p>the effect of CO2 on plant biomass yield varies with UV-B radiation levels.</p>
</blockquote>
<p>This simple phrasing describes any interaction.</p>
<div id="numerical-example-for-emphasis" class="section level4 hasAnchor" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Numerical example for emphasis<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#numerical-example-for-emphasis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s imagine the following situation. The folowing three numbers are what we call <em>Main Effects</em>:</p>
<p>Control = 20g Yield
UV-B = 10g Yield
C02 = 29g Yield</p>
<p>These numbers allow us to calculate the <em>Additive Effect</em>, where the effect of both CO2 and UV-B is simply estimated by adding the two independent effects together:</p>
<p>ADDITIVE RESULT: C02 + UV-B = 39g Yield</p>
<p>However, this additive outcome may not be what happens. Imagine if there were Synergy - the effects are more than the sum of the independent effects - or Antagonism - the effects are less than expected because one offsets the other.</p>
<p>SYNERGISTIC RESULT: C02 + UV-B = 60g Yield
ANTAGONISTIC RESULT: C02 + UV-B = 19g Yield</p>
</div>
<div id="the-factorial-design-why-study-interactions" class="section level4 hasAnchor" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> The Factorial Design: Why Study Interactions?<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#the-factorial-design-why-study-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The UV-B and C02 experiment could be thought of as two experiments – a Control vs UV-B and a Control vs C02 experiment. If we combine these we get a Factorial Experiment where we can actually estimate whether there is an interaction, and whether it is synergy or antagonism. In the factorial design for this example, there are four treatment levels and all combinations of all treatments.</p>
<ul>
<li>Control</li>
<li>UV-B</li>
<li>C02</li>
<li>UV-B + C02</li>
</ul>
<p>Some of you may be thinking that we could simply treat each of these treatment levels indepdently, as unique treatments levels - e.g. the one-way ANOVA. But we don’t. We design and analyse the data we collect in a two-way analysis - a factorial design. Two-way ANOVA is the design</p>
<p>Factorial treatments have two main advantages over the 1-way approach.</p>
<p>When factors <em>DO interact</em> – so the effect of C02 depends on UV-B – then we can estimate the interaction - the dependency. <em>One-way designs</em> cannot do this, and can lead to serious misunderstandings (because we are assuming that the effect of one thing DOES NOT depend on the other).</p>
<p>Furthermore, when factors <em>DON’T interact</em>, <em>factorial designs</em> are more precise (smaller error variance) at estimating the main (non-interacting effects) than one-way designs experiments.</p>
<p>Hence ALWAYS use factorial designs when your experimental design contains the interaction (when you are asking the question that includes the word(s) <em>depends</em> or <em>varies by</em>!</p>
</div>
</div>
</div>
<div id="a-factorial-design-and-the-two-way-anova" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> A Factorial Design and the Two-Way ANOVA<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#a-factorial-design-and-the-two-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following dataset <code>plantYield_factorial</code> contains two observation columns - <code>yield_ind</code> are data where there is NO INTERACTION. <code>yield_int</code> are data where there are an interaction. We will use both of these to showcase how to work the 2-way ANOVA and the analysis of a factorial design.</p>
<p>We note that these data have replication and randomisation. There are <em>four</em> replicate plants/plots allocated randomly to each of the four treatment combinations.</p>
<p>Here is the evidence of the factorial design</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span>UVB<span class="sc">+</span>CO2, <span class="at">data =</span> plantYield_factorial)</span></code></pre></div>
<pre><code>##       CO2
## UVB    Con CO2+
##   Con    4    4
##   UVB+   4    4</code></pre>
<div id="plot-the-factorial-design" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Plot the factorial design!<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#plot-the-factorial-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we combine some dplyr magic (calculating means in each group - there are two grouping variables!), some ggplot magic (adding the lines connecting the means on top of the raw data) and the beauty of patchwork, the package for plot layouts.</p>
<p>Our goal here is to plot the data that does not have the interaction next to a plot of the data that does have the interaction.</p>
<p><img src="Experimental-Design,-ANOVA-and-ANCOVA_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Given what you’ve read above, you should be able to fill in these blanks:</p>
<p>What you see above on the left, is a pattern that suggest that the effect of ______ on ________ does not vary by ________.</p>
<p>In contrast, on the right the pattern suggests that the effect of ______ on ________ ________ by ________:</p>
</div>
<div id="how-to-analyse-and-interpret-the-factorial-design" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> How to analyse and interpret the factorial design<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#how-to-analyse-and-interpret-the-factorial-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As with the plotting, we now analyse each data set.</p>
<p>We also make a mistake of analysing the data that has an interaction with a model that does not specify this interaction.</p>
<p>We are thus making three models. A model of the no interaction data without specifying and interaction, a model of the interaction data without specifying and interaction and a model of the interaction data with and interaction specified. This second model is incorrect, but fitting it helps illuminate why you should fit the interaction if your design contains the potential for an interaction (a factorial design).</p>
<blockquote>
<p>An Important Note on what + and * mean in models. In the below model specification, you will see CO2 + UVB and CO2 * UVB. Using the vocabulary from above, CO2 + UVB is specifying independent additive effects. In the ANOVA table produced by anova(), there will be three lines: one for CO2, one for UVB and one for residuals. In contrast, CO2 * UVB produces four lines of output in the ANOVA table. We say that CO2 * UVB expands to include the main, independent effects of CO2 and UVB, but also the interaction between them. So CO2 * UVB == CO2 + UVB + CO2:UVB where the last term is the interaction. Thus, there are four lines reported: one for CO2, one for UVB, one for the interaction and one for residuals.</p>
</blockquote>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A Correct model with no interaction on data with no interaction</span></span>
<span id="cb43-2"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-2" aria-hidden="true" tabindex="-1"></a>int_mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield_ind <span class="sc">~</span> CO2 <span class="sc">+</span> UVB, <span class="at">data =</span> plantYield_factorial)</span>
<span id="cb43-3"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A Correct model with interaction where the should be an interaction</span></span>
<span id="cb43-5"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-5" aria-hidden="true" tabindex="-1"></a>int_mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield_int <span class="sc">~</span> CO2 <span class="sc">*</span> UVB, <span class="at">data =</span> plantYield_factorial)</span>
<span id="cb43-6"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># THE WRONG MODEL: model without interaction, on data that should use the interaction</span></span>
<span id="cb43-8"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-8" aria-hidden="true" tabindex="-1"></a>int_mod_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield_int <span class="sc">~</span> CO2 <span class="sc">+</span> UVB, <span class="at">data =</span> plantYield_factorial)</span>
<span id="cb43-9"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(int_mod_1) <span class="co"># Good model, no interaction in the data and none in the model</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield_ind
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## CO2        1 321.00  321.00  35.905 4.504e-05 ***
## UVB        1 241.27  241.27  26.987 0.0001726 ***
## Residuals 13 116.22    8.94                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(int_mod_2) <span class="co"># Good model, interaction in the data and interaction in the model</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield_int
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## CO2        1 671.67  671.67 70.0311 2.364e-06 ***
## UVB        1  56.75   56.75  5.9165   0.03159 *  
## CO2:UVB    1  82.15   82.15  8.5654   0.01268 *  
## Residuals 12 115.09    9.59                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(int_mod_3) <span class="co"># Bad model, interaction in the data, but failure to specify in the model</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield_int
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## CO2        1 671.67  671.67  44.269 1.58e-05 ***
## UVB        1  56.75   56.75   3.740  0.07519 .  
## Residuals 13 197.24   15.17                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Let’s focus on model 2 and how we interpret this. The ANOVA table now has multiple rows. We saw this before with the block design. The important thing to note here is that the table is now read <em>sequentially</em>. We first note that CO2 explains <span class="math inline">\(507.19\)</span> units of variation (Mean Sq) in plant Yield. Having captured this variation, we then note that UVB captures <span class="math inline">\(216.29\)</span> additional units. Then, having capture the variation caused directly by CO2 and UVB, we now see that the interaction - asking whether the effect of CO2 varies by UVB - explains an additional <span class="math inline">\(127.72\)</span> units. And… there are <span class="math inline">\(11.11\)</span> units of unexplained variation.</p>
<p>Great. So, remember as well how we calculate the F-value. In the ANOVA (categorial variable) framework, the F-value is the ratio of variance explained by the factor relative to the residual variation. So that’s where the F values come from…. And recall that BIG F-values indicate that more variation is allocated to the treatment levels, versus what’s left over. The bigger the numerator value relative to the residual denominator, the more variation this term has explained.</p>
<p>In this experimental design, and any like it, one must remember that there is actually a single question, and it does not related to the independent main effects.It relates only to the interaction term: we designed this experiment to test the hypothesis that the effect of CO2 on yield varies by UVB. There is only a single choice of answer - yes or no. In this case, having captured variation with each independent effect, there is still a large amount of variation captured by ‘allowing’ the effects of each to vary by the other. Under a null hypothesis that these two variables to not interact (do not depend on each other), getting a Mean square estimate of <span class="math inline">\(127.72\)</span> relative to the residual of <span class="math inline">\(11.11\)</span> is very unlikely. So we reject the null!</p>
<p>Spend some time investigating what has happened with model 2 and model 3 and recall that ONLY ONE OF THEM IS CORRECT, regardless of whether the data look like the left or right panel above. Note the differences in the outputs. Note what we infer if we model the interaction data incorrectly.</p>
<p>There is no free lunch.</p>
<p>You must understand your data and your question and you must fit the model that correctly matches your design! In this case, there really is only one model you should fit. It is model 2. EVEN if the data look like the left panel, with no interaction, this experiment was designed to test the hypothesis that the effect of CO2 varies by UVB. You can only accept or reject the null hypothesis of no interaction by fitting model 2. You can not guess the right model from the picture. The design dictates the model. But, you can guess the answer….</p>
</div>
<div id="visreg-and-the-2-way-anova" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> visreg and the 2-way ANOVA<a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#visreg-and-the-2-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Don’t forget that the correct standard error for the ‘result’ is the residuals mean squared. You can use the dplyr + ggplot2 method, or visreg to estimate these. Here we use visreg and put the figure next to our original ggplot for the interaction data. Either of these would be OK for presentation, and most would opt for the left panel. Note the use of the the correct model for the design and quesion (model 2).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb49-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">visreg</span>(int_mod_2,<span class="st">&quot;CO2&quot;</span>,<span class="at">by=</span><span class="st">&quot;UVB&quot;</span>, <span class="at">gg=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb49-2"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb49-3"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="designs-for-testing-for-interactions-the-two-way-anova-and-factorial-designs..html#cb49-4" aria-hidden="true" tabindex="-1"></a>p2<span class="sc">+</span>p3</span></code></pre></div>
<p><img src="Experimental-Design,-ANOVA-and-ANCOVA_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="design-and-analysis-of-experiments.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactions-part-2-introducing-the-ancova-analysis-of-covariance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-Interactions-_The_2-way_ANOVA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Experimental Design, ANOVA and ANCOVA.pdf", "Experimental Design, ANOVA and ANCOVA.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
